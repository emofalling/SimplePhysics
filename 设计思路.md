# 设计思路摘要

## main

### 当没有发生碰撞时

根据牛顿第二定律：

$$
F = ma
$$

可得当前的加速度应为：

$$
a = \frac{F_合}{m}
$$

同时，根据：

$$
x_d = \int_{t_0}^{t_0+t_d} {v(t)dt} = \int{t_0}^{t_0+t_d} {(v_0 + at) dt} = v_0t + \frac{1}{2}at^2
$$

可更新位移和速度：

$$
x = x + v_0t + \frac{1}{2}at^2 \\
v = v_0 + at
$$

### 当发生碰撞时

计算碰撞法向向量$\hat{n}$和切向向量$\hat{t}$，将速度分解到法向和切向。

将速度分解到法向和切向：

$$
v_{1\hat{n}} = v_{1}\hat{n} \\
v_{1\hat{t}} = v_{1}\hat{t} = v_1 - v_{1\hat{n}} \\
v_{2\hat{n}} = v_{2}\hat{n} \\
v_{2\hat{t}} = v_{2}\hat{t} = v_2 - v_{2\hat{n}}
$$

先考虑一维下的碰撞：

已知动量守恒定律：

$$
m_1\vec{v_1} + m_2\vec{v_2} = m_1\vec{v_1'} + m_2\vec{v_2'}
$$

和动能守恒定律：

$$
\frac{1}{2}m_1v_1^2 + \frac{1}{2}m_2v_2^2 = \frac{1}{2}m_1v_1'^2 + \frac{1}{2}m_2v_2'^2
$$

联立求解得：

$$
v_1' = \frac{(m_1 - m_2)v_1 + 2m_2v_2}{m_1 + m_2} \\
v_2' = \frac{2m_1v_1 + (m_2 - m_1)v_2}{m_1 + m_2}
$$

代入二维：

$$
v_{1\hat{n}'} = \frac{(m_1 - m_2)v_{1\hat{n}} + 2m_2v_{2\hat{n}}}{m_1 + m_2} \\
v_{2\hat{n}'} = \frac{2m_1v_{1\hat{n}} + (m_2 - m_1)v_{2\hat{n}}}{m_1 + m_2}
$$

切向速度不变。

合成：

$$
v_{1'} = v_{1\hat{n}'} + v_{1\hat{t}} \\
v_{2'} = v_{2\hat{n}'} + v_{2\hat{t}}
$$

## 如何分解碰撞法向和切向

对于两球碰撞：

- 法向：球心连线的单位向量
- 切向：垂直于法向的向量

对于任意物体与平面的碰撞：

- 法向：平面法向
- 切向：垂直于法向的向量
